{"ast":null,"code":"import _classCallCheck from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/src/Pages/Admin/Configuration.js\";\nimport React, { Component } from 'react';\nimport { withCookies } from 'react-cookie';\nimport { isUUID } from 'validator';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nimport { resetClient, Client } from '../../Client';\nimport SpinnerBox from '../../Components/SpinnerBox';\nimport { defaultProjectId, selectedProjectCookieName, getSampleProjectItems } from '../../Utilities/SelectedProject';\nimport { resetStores } from '../../Utilities/StoreManager';\nimport KontentLogo from \"../../Images/Admin/kk-logo.svg\";\nimport './Admin.css';\n\nvar getWindowCenterPosition = function getWindowCenterPosition(windowWidth, windowHeight) {\n  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  var screenWidth = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  var screenHeight = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  var left = screenWidth / 2 - windowWidth / 2 + dualScreenLeft;\n  var top = screenHeight / 2 - windowHeight / 2 + dualScreenTop;\n  return {\n    left: left,\n    top: top\n  };\n};\n\nvar Configuration =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Configuration, _Component);\n\n  function Configuration(props) {\n    var _this;\n\n    _classCallCheck(this, Configuration);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Configuration).call(this, props));\n    _this.state = {\n      currentProjectInputValue: _this.props.cookies.get(selectedProjectCookieName),\n      preparingProject: false,\n      unsubscribe: new Subject()\n    };\n    _this.handleProjectInputChange = _this.handleProjectInputChange.bind(_assertThisInitialized(_this));\n    _this.handleSetProjectSubmit = _this.handleSetProjectSubmit.bind(_assertThisInitialized(_this));\n    _this.setNewProjectId = _this.setNewProjectId.bind(_assertThisInitialized(_this));\n    _this.receiveMessage = _this.receiveMessage.bind(_assertThisInitialized(_this));\n    _this.unsubscribe = _this.unsubscribe.bind(_assertThisInitialized(_this));\n    _this.waitUntilProjectAccessible = _this.waitUntilProjectAccessible.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Configuration, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener('message', this.receiveMessage, false);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('message', this.receiveMessage);\n      this.unsubscribe();\n    }\n  }, {\n    key: \"handleProjectInputChange\",\n    value: function handleProjectInputChange(event) {\n      this.setState({\n        currentProjectInputValue: event.target.value\n      });\n    }\n  }, {\n    key: \"handleSetProjectSubmit\",\n    value: function handleSetProjectSubmit(event) {\n      event.preventDefault();\n      var newProjectId = event.target[0].value;\n      this.setNewProjectId(newProjectId);\n    }\n  }, {\n    key: \"setNewProjectId\",\n    value: function setNewProjectId(newProjectId, newlyGeneratedProject) {\n      if (!isUUID(newProjectId)) {\n        var message = \"Selected project (\".concat(newProjectId, \") is not a valid GUID\");\n        console.error(message);\n        alert(message);\n        this.setState({\n          currentProjectInputValue: this.props.cookies.get(selectedProjectCookieName)\n        });\n        return;\n      }\n\n      resetClient(newProjectId);\n      resetStores();\n\n      if (newlyGeneratedProject) {\n        this.waitUntilProjectAccessible(newProjectId);\n        this.setState({\n          preparingProject: true\n        });\n        return;\n      }\n\n      this.redirectToHome(newProjectId);\n    }\n  }, {\n    key: \"waitUntilProjectAccessible\",\n    value: function waitUntilProjectAccessible(newProjectId) {\n      var _this2 = this;\n\n      setTimeout(function () {\n        Client.items().elementsParameter(['id']).depthParameter(0).toObservable().pipe(takeUntil(_this2.state.unsubscribe)).subscribe(function (response) {\n          var sampleProjectListingResponse = getSampleProjectItems().subscribe(function (sampleProjectClientResult) {\n            if (response.items.length >= sampleProjectClientResult.items.length) {\n              _this2.setState({\n                preparingProject: false\n              });\n\n              sampleProjectListingResponse.unsubscribe();\n\n              _this2.redirectToHome(newProjectId);\n            } else {\n              sampleProjectListingResponse.unsubscribe();\n\n              _this2.waitUntilProjectAccessible(newProjectId);\n            }\n          });\n        });\n      }, 2000);\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      this.state.unsubscribe.next();\n      this.state.unsubscribe.complete();\n      this.setState({\n        unsubscribe: new Subject()\n      });\n    }\n  }, {\n    key: \"redirectToHome\",\n    value: function redirectToHome(newProjectId) {\n      var infoMessage = newProjectId === defaultProjectId ? \"You've configured your app to with a project ID of a shared Kentico Kontent project.\" : \"You've configured your app with a project ID \\\"\".concat(newProjectId, \"\\\". You can edit its contents at https://kontent.ai/.\");\n      this.props.history.push(\"/?infoMessage=\".concat(infoMessage));\n    }\n  }, {\n    key: \"openKenticoKontentProjectSelector\",\n    value: function openKenticoKontentProjectSelector(event) {\n      event.preventDefault();\n      var windowWidth = 800;\n      var windowHeight = 800;\n\n      var _getWindowCenterPosit = getWindowCenterPosition(windowWidth, windowHeight),\n          left = _getWindowCenterPosit.left,\n          top = _getWindowCenterPosit.top;\n\n      window.open('https://app.kontent.ai/sample-site-configuration', 'Kentico Kontent', \"status=no,width=\".concat(windowWidth, \",height=\").concat(windowHeight, \",resizable=yes,left=\\n      \").concat(left, \",top=\").concat(top, \",toolbar=no,menubar=no,location=no,directories=no\"));\n    }\n  }, {\n    key: \"receiveMessage\",\n    value: function receiveMessage(event) {\n      if (event.origin.toLowerCase() !== 'https://app.kontent.ai') return;\n\n      if (!event.data.projectGuid) {\n        return;\n      }\n\n      this.setNewProjectId(event.data.projectGuid, event.data.newlyGeneratedProject);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var message = this.state.preparingProject && React.createElement(SpinnerBox, {\n        message: \"Waiting for the sample project to become ready...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      });\n      return React.createElement(\"div\", {\n        className: \"project-configuration-section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"logotype-row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"logotype\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: \"/\",\n        className: \"logotype-link\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: KontentLogo,\n        alt: \"Kentico Kontent logo\",\n        id: \"KenticoKontent\",\n        width: \"100%\",\n        height: \"100%\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }))))), React.createElement(\"header\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"Sample Site\\u2014Configuration\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, \"For your sample app to work, you should have a Kentico Kontent project containing content. Your app should be then configured with its project ID. You can either get it by signing in using your Kentico Kontent credentials or by signing up for a trial. Later, it will be converted to a free plan.\"), message)), React.createElement(\"section\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, \"Get a Project ID\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, \"You may wish to either select from existing projects or create a new sample project. The app will be configured with its project ID.\"), React.createElement(\"form\", {\n        onSubmit: this.openKenticoKontentProjectSelector,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"button-secondary\",\n        value: \"Get Project ID from Kentico Kontent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"content sections-secondary divided\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, React.createElement(\"section\", {\n        className: \"section-secondary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, \"Set A Project ID Manually\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, \"Alternatively, you can configure your app manually by submitting a project ID below.\"), React.createElement(\"div\", {\n        className: \"inline-controls\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: this.handleSetProjectSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"ProjectGuid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, \"ProjectGuid\")), React.createElement(\"div\", {\n        className: \"form-group-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"ProjectGuid\",\n        name: \"ProjectGuid\",\n        placeholder: \"ProjectGuid\",\n        type: \"text\",\n        value: this.state.currentProjectInputValue,\n        onChange: this.handleProjectInputChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"message-validation\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"field-validation-valid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }))), React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"button-secondary\",\n        value: \"Submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      })))), React.createElement(\"section\", {\n        className: \"section-secondary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, \"Use the Shared Project\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, \"Alternatively, you may wish to use the shared project (project ID \\\"\", defaultProjectId, \"\\\").\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, \"Note:\"), \" You cannot edit content in the shared project.\"), React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"button-secondary\",\n        value: \"Use the shared project\",\n        onClick: function onClick() {\n          return _this3.setNewProjectId(defaultProjectId);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return Configuration;\n}(Component);\n\nexport default withCookies(Configuration);","map":{"version":3,"sources":["/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/src/Pages/Admin/Configuration.js"],"names":["React","Component","withCookies","isUUID","takeUntil","Subject","resetClient","Client","SpinnerBox","defaultProjectId","selectedProjectCookieName","getSampleProjectItems","resetStores","getWindowCenterPosition","windowWidth","windowHeight","dualScreenLeft","window","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","screenWidth","innerWidth","document","documentElement","clientWidth","screen","width","screenHeight","innerHeight","clientHeight","height","left","top","Configuration","props","state","currentProjectInputValue","cookies","get","preparingProject","unsubscribe","handleProjectInputChange","bind","handleSetProjectSubmit","setNewProjectId","receiveMessage","waitUntilProjectAccessible","addEventListener","removeEventListener","event","setState","target","value","preventDefault","newProjectId","newlyGeneratedProject","message","console","error","alert","redirectToHome","setTimeout","items","elementsParameter","depthParameter","toObservable","pipe","subscribe","response","sampleProjectListingResponse","sampleProjectClientResult","length","next","complete","infoMessage","history","push","open","origin","toLowerCase","data","projectGuid","KontentLogo","openKenticoKontentProjectSelector"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { withCookies } from 'react-cookie';\nimport { isUUID } from 'validator';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\n\nimport { resetClient, Client } from '../../Client';\nimport SpinnerBox from '../../Components/SpinnerBox';\nimport {\n  defaultProjectId,\n  selectedProjectCookieName,\n  getSampleProjectItems\n} from '../../Utilities/SelectedProject';\nimport { resetStores } from '../../Utilities/StoreManager';\n\nimport KontentLogo from '../../Images/Admin/kk-logo.svg';\n\nimport './Admin.css';\n\nconst getWindowCenterPosition = (windowWidth, windowHeight) => {\n  const dualScreenLeft =\n    window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  const dualScreenTop =\n    window.screenTop !== undefined ? window.screenTop : window.screenY;\n  const screenWidth = window.innerWidth\n    ? window.innerWidth\n    : document.documentElement.clientWidth\n      ? document.documentElement.clientWidth\n      : window.screen.width;\n  const screenHeight = window.innerHeight\n    ? window.innerHeight\n    : document.documentElement.clientHeight\n      ? document.documentElement.clientHeight\n      : window.screen.height;\n  const left = screenWidth / 2 - windowWidth / 2 + dualScreenLeft;\n  const top = screenHeight / 2 - windowHeight / 2 + dualScreenTop;\n  return { left, top };\n};\n\nclass Configuration extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentProjectInputValue: this.props.cookies.get(\n        selectedProjectCookieName\n      ),\n      preparingProject: false,\n      unsubscribe: new Subject()\n    };\n\n    this.handleProjectInputChange = this.handleProjectInputChange.bind(this);\n    this.handleSetProjectSubmit = this.handleSetProjectSubmit.bind(this);\n    this.setNewProjectId = this.setNewProjectId.bind(this);\n    this.receiveMessage = this.receiveMessage.bind(this);\n    this.unsubscribe = this.unsubscribe.bind(this);\n    this.waitUntilProjectAccessible = this.waitUntilProjectAccessible.bind(\n      this\n    );\n  }\n\n  componentDidMount() {\n    window.addEventListener('message', this.receiveMessage, false);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('message', this.receiveMessage);\n    this.unsubscribe();\n  }\n\n  handleProjectInputChange(event) {\n    this.setState({ currentProjectInputValue: event.target.value });\n  }\n\n  handleSetProjectSubmit(event) {\n    event.preventDefault();\n    const newProjectId = event.target[0].value;\n    this.setNewProjectId(newProjectId);\n  }\n\n  setNewProjectId(newProjectId, newlyGeneratedProject) {\n    if (!isUUID(newProjectId)) {\n      const message = `Selected project (${newProjectId}) is not a valid GUID`;\n      console.error(message);\n      alert(message);\n      this.setState({\n        currentProjectInputValue: this.props.cookies.get(\n          selectedProjectCookieName\n        )\n      });\n      return;\n    }\n\n    resetClient(newProjectId);\n    resetStores();\n    if (newlyGeneratedProject) {\n      this.waitUntilProjectAccessible(newProjectId);\n      this.setState({\n        preparingProject: true\n      });\n      return;\n    }\n\n    this.redirectToHome(newProjectId);\n  }\n\n  waitUntilProjectAccessible(newProjectId) {\n    setTimeout(() => {\n      Client.items()\n        .elementsParameter(['id'])\n        .depthParameter(0)\n        .toObservable()\n        .pipe(takeUntil(this.state.unsubscribe))\n        .subscribe(response => {\n          const sampleProjectListingResponse = getSampleProjectItems().subscribe(\n            sampleProjectClientResult => {\n              if (\n                response.items.length >= sampleProjectClientResult.items.length\n              ) {\n                this.setState({\n                  preparingProject: false\n                });\n                sampleProjectListingResponse.unsubscribe();\n                this.redirectToHome(newProjectId);\n              } else {\n                sampleProjectListingResponse.unsubscribe();\n                this.waitUntilProjectAccessible(newProjectId);\n              }\n            }\n          );\n        });\n    }, 2000);\n  }\n\n  unsubscribe() {\n    this.state.unsubscribe.next();\n    this.state.unsubscribe.complete();\n    this.setState({\n      unsubscribe: new Subject()\n    });\n  }\n\n  redirectToHome(newProjectId) {\n    const infoMessage =\n      newProjectId === defaultProjectId\n        ? `You've configured your app to with a project ID of a shared Kentico Kontent project.`\n        : `You've configured your app with a project ID \"${newProjectId}\". You can edit its contents at https://kontent.ai/.`;\n    this.props.history.push(`/?infoMessage=${infoMessage}`);\n  }\n\n  openKenticoKontentProjectSelector(event) {\n    event.preventDefault();\n    const windowWidth = 800;\n    const windowHeight = 800;\n    const { left, top } = getWindowCenterPosition(windowWidth, windowHeight);\n\n    window.open(\n      'https://app.kontent.ai/sample-site-configuration',\n      'Kentico Kontent',\n      `status=no,width=${windowWidth},height=${windowHeight},resizable=yes,left=\n      ${left},top=${top},toolbar=no,menubar=no,location=no,directories=no`\n    );\n  }\n\n  receiveMessage(event) {\n    if (event.origin.toLowerCase() !== 'https://app.kontent.ai') return;\n\n    if (!event.data.projectGuid) {\n      return;\n    }\n\n    this.setNewProjectId(\n      event.data.projectGuid,\n      event.data.newlyGeneratedProject\n    );\n  }\n\n  render() {\n    const message = this.state.preparingProject && (\n      <SpinnerBox message=\"Waiting for the sample project to become ready...\" />\n    );\n    return (\n      <div className=\"project-configuration-section\">\n        <div className=\"logotype-row\">\n          <div className=\"content\">\n            <div className=\"logotype\">\n              <a href=\"/\" className=\"logotype-link\">\n                <img\n                  src={KontentLogo}\n                  alt=\"Kentico Kontent logo\"\n                  id=\"KenticoKontent\"\n                  width=\"100%\"\n                  height=\"100%\"\n                />\n              </a>\n            </div>\n          </div>\n        </div>\n        <header>\n          <div className=\"content\">\n            <h1>Sample Siteâ€”Configuration</h1>\n            <p>\n              For your sample app to work, you should have a Kentico Kontent\n              project containing content. Your app should be then configured\n              with its project ID. You can either get it by signing in using\n              your Kentico Kontent credentials or by signing up for a trial.\n              Later, it will be converted to a free plan.\n            </p>\n            {message}\n          </div>\n        </header>\n        <section>\n          <h2>Get a Project ID</h2>\n          <p>\n            You may wish to either select from existing projects or create a new\n            sample project. The app will be configured with its project ID.\n          </p>\n          <form onSubmit={this.openKenticoKontentProjectSelector}>\n            <input\n              type=\"submit\"\n              className=\"button-secondary\"\n              value=\"Get Project ID from Kentico Kontent\"\n            />\n          </form>\n        </section>\n        <div className=\"content sections-secondary divided\">\n          <section className=\"section-secondary\">\n            <h2>Set A Project ID Manually</h2>\n            <p>\n              Alternatively, you can configure your app manually by submitting a\n              project ID below.\n            </p>\n            <div className=\"inline-controls\">\n              <form onSubmit={this.handleSetProjectSubmit}>\n                <div className=\"form-group\">\n                  <div className=\"form-group-label\">\n                    <label htmlFor=\"ProjectGuid\">ProjectGuid</label>\n                  </div>\n                  <div className=\"form-group-input\">\n                    <input\n                      id=\"ProjectGuid\"\n                      name=\"ProjectGuid\"\n                      placeholder=\"ProjectGuid\"\n                      type=\"text\"\n                      value={this.state.currentProjectInputValue}\n                      onChange={this.handleProjectInputChange}\n                    />\n                  </div>\n                  <div className=\"message-validation\">\n                    <span className=\"field-validation-valid\" />\n                  </div>\n                </div>\n                <input\n                  type=\"submit\"\n                  className=\"button-secondary\"\n                  value=\"Submit\"\n                />\n              </form>\n            </div>\n          </section>\n          <section className=\"section-secondary\">\n            <h2>Use the Shared Project</h2>\n            <p>\n              Alternatively, you may wish to use the shared project (project ID\n              \"{defaultProjectId}\n              \").\n            </p>\n            <p>\n              <strong>Note:</strong> You cannot edit content in the shared\n              project.\n            </p>\n            <input\n              type=\"submit\"\n              className=\"button-secondary\"\n              value=\"Use the shared project\"\n              onClick={() => this.setNewProjectId(defaultProjectId)}\n            />\n          </section>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withCookies(Configuration);\n"]},"metadata":{},"sourceType":"module"}