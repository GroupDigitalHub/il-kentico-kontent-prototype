{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar models_1 = require(\"../models\");\n\nvar DeliveryItemStronglyTypeResolver =\n/** @class */\nfunction () {\n  function DeliveryItemStronglyTypeResolver() {\n    this.systemElementName = 'system';\n    this.elementsElementName = 'elements';\n  }\n  /**\r\n   * Creates item instance using either TypeResolver (if registered) or returns ContentItem\r\n   */\n\n\n  DeliveryItemStronglyTypeResolver.prototype.createItemInstance = function (type, data, typeResolvers) {\n    var typeResolver = this.getTypeResolver(type, typeResolvers);\n    var itemInstance;\n\n    if (typeResolver) {\n      // type resolver is registered, create new instance of given type\n      itemInstance = this.createInstanceWithResolver(data, typeResolver);\n    } else {\n      // not type resolver is register for this type, use ContentItem\n      itemInstance = this.createContentItem(data.item);\n    }\n\n    if (!itemInstance) {\n      throw Error(\"Item with codename '\" + data.item.system.codename + \"' could not be instantiated\");\n    }\n\n    this.assignRequiredContentItemData(itemInstance, data.item);\n    return itemInstance;\n  };\n  /**\r\n   * Maps raw system response to strongly typed class\r\n   * @param rawSystem Raw system response\r\n   */\n\n\n  DeliveryItemStronglyTypeResolver.prototype.mapSystemAttributes = function (rawSystem) {\n    return new models_1.ContentItemSystemAttributes({\n      name: rawSystem.name,\n      codename: rawSystem.codename,\n      id: rawSystem.id,\n      lastModified: new Date(rawSystem.last_modified),\n      language: rawSystem.language,\n      type: rawSystem.type,\n      sitemapLocations: rawSystem.sitemap_locations\n    });\n  };\n  /**\r\n   * Creates new instance of given type\r\n   * @param type Type of the content item\r\n   * @param resolvers Type resolvers\r\n   */\n\n\n  DeliveryItemStronglyTypeResolver.prototype.createInstanceWithResolver = function (data, resolver) {\n    return resolver.resolve(data);\n  };\n  /**\r\n   * Gets TypeResolver associated with given type (type = codename of Kentico Kontent content type)\r\n   * @param type Kentico Kontent content type codename\r\n   * @param resolvers Array of TypeResolver\r\n   */\n\n\n  DeliveryItemStronglyTypeResolver.prototype.getTypeResolver = function (type, resolvers) {\n    return resolvers.find(function (m) {\n      return m.type.toLowerCase() === type.toLowerCase();\n    });\n  };\n  /**\r\n   * Creates base ContentItem when content type does not have a strongly typed model\r\n   */\n\n\n  DeliveryItemStronglyTypeResolver.prototype.createContentItem = function (item) {\n    var contentItem = new models_1.ContentItem();\n    this.assignRequiredContentItemData(contentItem, item);\n    return contentItem;\n  };\n  /**\r\n   * Maps default properties (system & elements)\r\n   * @param item Mapped content item\r\n   * @param rawItem Raw content item from response\r\n   */\n\n\n  DeliveryItemStronglyTypeResolver.prototype.assignRequiredContentItemData = function (item, rawItem) {\n    item.system = this.mapSystemAttributes(rawItem[this.systemElementName]);\n    item._raw = {\n      elements: rawItem[this.elementsElementName]\n    };\n  };\n\n  return DeliveryItemStronglyTypeResolver;\n}();\n\nexports.DeliveryItemStronglyTypeResolver = DeliveryItemStronglyTypeResolver;\nexports.stronglyTypedResolver = new DeliveryItemStronglyTypeResolver();","map":null,"metadata":{},"sourceType":"script"}