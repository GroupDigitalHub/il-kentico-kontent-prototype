{"ast":null,"code":"import _classCallCheck from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { Client } from '../Client.js';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nimport { initLanguageCodeObject, defaultLanguage, languageCodes } from '../Utilities/LanguageCodes';\nimport { spinnerService } from '@simply007org/react-spinners';\n\nvar _unsubscribe = new Subject();\n\nvar changeListeners = [];\n\nvar resetStore = function resetStore() {\n  var languageInitialized = {};\n  languageCodes.forEach(function (language) {\n    languageInitialized[language] = false;\n  });\n  return {\n    cafes: initLanguageCodeObject(),\n    languageInitialized: languageInitialized\n  };\n};\n\nvar _resetStore = resetStore(),\n    cafes = _resetStore.cafes,\n    languageInitialized = _resetStore.languageInitialized;\n\nvar notifyChange = function notifyChange(newlanguage) {\n  changeListeners.forEach(function (listener) {\n    listener(newlanguage);\n  });\n};\n\nvar fetchCafes = function fetchCafes(language) {\n  if (languageInitialized[language]) {\n    notifyChange(language);\n    return;\n  }\n\n  var query = Client.items().type('cafe').orderParameter('system.name');\n\n  if (language) {\n    query.languageParameter(language);\n  }\n\n  query.toObservable().pipe(takeUntil(_unsubscribe)).subscribe(function (response) {\n    if (language) {\n      cafes[language] = response.items;\n    } else {\n      cafes[defaultLanguage] = response.items;\n    }\n\n    notifyChange(language);\n    languageInitialized[language] = true;\n  });\n};\n\nvar Cafe =\n/*#__PURE__*/\nfunction () {\n  function Cafe() {\n    _classCallCheck(this, Cafe);\n  }\n\n  _createClass(Cafe, [{\n    key: \"providePartnerCafes\",\n    // Actions\n    value: function providePartnerCafes(language) {\n      if (spinnerService.isShowing('apiSpinner') === false) {\n        spinnerService.show('apiSpinner');\n      }\n\n      fetchCafes(language);\n    }\n  }, {\n    key: \"provideCompanyCafes\",\n    value: function provideCompanyCafes(language) {\n      if (spinnerService.isShowing('apiSpinner') === false) {\n        spinnerService.show('apiSpinner');\n      }\n\n      fetchCafes(language);\n    } // Methods\n\n  }, {\n    key: \"getPartnerCafes\",\n    value: function getPartnerCafes(language) {\n      spinnerService.hide('apiSpinner');\n      return cafes[language].filter(function (cafe) {\n        return cafe.country.value !== 'USA';\n      });\n    }\n  }, {\n    key: \"getCompanyCafes\",\n    value: function getCompanyCafes(language) {\n      spinnerService.hide('apiSpinner');\n      return cafes[language].filter(function (cafe) {\n        return cafe.country.value === 'USA';\n      });\n    } // Listeners\n\n  }, {\n    key: \"addChangeListener\",\n    value: function addChangeListener(listener) {\n      changeListeners.push(listener);\n    }\n  }, {\n    key: \"removeChangeListener\",\n    value: function removeChangeListener(listener) {\n      changeListeners = changeListeners.filter(function (element) {\n        return element !== listener;\n      });\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      _unsubscribe.next();\n\n      _unsubscribe.complete();\n\n      _unsubscribe = new Subject();\n    }\n  }]);\n\n  return Cafe;\n}();\n\nvar CafeStore = new Cafe();\nexport { CafeStore, resetStore };","map":{"version":3,"sources":["/Users/markirishlife/Desktop/development/kenticoKontent/kontent-sample-app-react/src/Stores/Cafe.js"],"names":["Client","takeUntil","Subject","initLanguageCodeObject","defaultLanguage","languageCodes","spinnerService","unsubscribe","changeListeners","resetStore","languageInitialized","forEach","language","cafes","notifyChange","newlanguage","listener","fetchCafes","query","items","type","orderParameter","languageParameter","toObservable","pipe","subscribe","response","Cafe","isShowing","show","hide","filter","cafe","country","value","push","element","next","complete","CafeStore"],"mappings":"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","sourcesContent":["import { Client } from '../Client.js';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nimport {\n  initLanguageCodeObject,\n  defaultLanguage,\n  languageCodes\n} from '../Utilities/LanguageCodes';\nimport { spinnerService } from '@simply007org/react-spinners';\n\nlet unsubscribe = new Subject();\nlet changeListeners = [];\nconst resetStore = () => {\n  let languageInitialized = {};\n  languageCodes.forEach(language => {\n    languageInitialized[language] = false;\n  });\n\n  return {\n    cafes: initLanguageCodeObject(),\n    languageInitialized: languageInitialized\n  };\n};\nlet { cafes, languageInitialized } = resetStore();\n\nlet notifyChange = newlanguage => {\n  changeListeners.forEach(listener => {\n    listener(newlanguage);\n  });\n};\n\nlet fetchCafes = language => {\n  if (languageInitialized[language]) {\n    notifyChange(language);\n    return;\n  }\n\n  let query = Client.items()\n    .type('cafe')\n    .orderParameter('system.name');\n  if (language) {\n    query.languageParameter(language);\n  }\n\n  query\n    .toObservable()\n    .pipe(takeUntil(unsubscribe))\n    .subscribe(response => {\n      if (language) {\n        cafes[language] = response.items;\n      } else {\n        cafes[defaultLanguage] = response.items;\n      }\n      notifyChange(language);\n      languageInitialized[language] = true;\n    });\n};\n\nclass Cafe {\n  // Actions\n\n  providePartnerCafes(language) {\n    if (spinnerService.isShowing('apiSpinner') === false) {\n      spinnerService.show('apiSpinner');\n    }\n    fetchCafes(language);\n  }\n\n  provideCompanyCafes(language) {\n    if (spinnerService.isShowing('apiSpinner') === false) {\n      spinnerService.show('apiSpinner');\n    }\n    fetchCafes(language);\n  }\n\n  // Methods\n\n  getPartnerCafes(language) {\n    spinnerService.hide('apiSpinner');\n    return cafes[language].filter(cafe => cafe.country.value !== 'USA');\n  }\n\n  getCompanyCafes(language) {\n    spinnerService.hide('apiSpinner');\n    return cafes[language].filter(cafe => cafe.country.value === 'USA');\n  }\n\n  // Listeners\n\n  addChangeListener(listener) {\n    changeListeners.push(listener);\n  }\n\n  removeChangeListener(listener) {\n    changeListeners = changeListeners.filter(element => {\n      return element !== listener;\n    });\n  }\n\n  unsubscribe() {\n    unsubscribe.next();\n    unsubscribe.complete();\n    unsubscribe = new Subject();\n  }\n}\nlet CafeStore = new Cafe();\n\nexport { CafeStore, resetStore };\n"]},"metadata":{},"sourceType":"module"}